{"ast":null,"code":"import { ofType } from 'redux-observable';\nimport { of, mergeMap, catchError } from 'rxjs';\nimport { connectToWs } from \"../actions\";\nvar success = function success(payload) {\n  globalThis.socket = payload;\n  return of({\n    type: 'Success connecting to websocket'\n  });\n};\nvar failure = function failure(payload) {\n  return of({\n    type: 'Failed connecting to websocket '\n  });\n};\nvar connect = function connect(state$) {\n  return function () {\n    var otp = state$.value.profile.data.otp;\n    var websocket = new WebSocket(\"ws://localhost:8080/ws?otp=\" + otp);\n    return of(websocket).pipe(mergeMap(success)).pipe(catchError(failure));\n  };\n};\nexport default (function (action$, state$) {\n  return action$.pipe(ofType(connectToWs.type)).pipe(mergeMap(connect(state$)));\n});","map":{"version":3,"names":["ofType","of","mergeMap","catchError","connectToWs","success","payload","globalThis","socket","type","failure","connect","state$","otp","value","profile","data","websocket","WebSocket","pipe","action$"],"sources":["/home/nerds-pc/Projects/chat-app/frontend/src/ws/epics/connect-to-ws.ts"],"sourcesContent":["import { ofType } from 'redux-observable'\nimport { of, mergeMap, catchError } from 'rxjs'\nimport { connectToWs } from '../actions'\n\nconst success = payload => {\n  globalThis.socket = payload\n\n  return of({type: 'Success connecting to websocket'})\n}\n\nconst failure = payload => {\n  return of({type: 'Failed connecting to websocket '})\n}\n\nconst connect = (state$: any) => () => {\n  const otp = state$.value.profile.data.otp\n  const websocket = new WebSocket(`ws://localhost:8080/ws?otp=${otp}`)\n\n  return of(websocket)\n    .pipe(mergeMap(success))\n    .pipe(catchError(failure))\n}\n\nexport default (action$, state$) => action$\n  .pipe(ofType(connectToWs.type))\n  .pipe(mergeMap(connect(state$)))\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,kBAAkB;AACzC,SAASC,EAAE,EAAEC,QAAQ,EAAEC,UAAU,QAAQ,MAAM;AAC/C,SAASC,WAAW;AAEpB,IAAMC,OAAO,GAAG,SAAVA,OAAOA,CAAGC,OAAO,EAAI;EACzBC,UAAU,CAACC,MAAM,GAAGF,OAAO;EAE3B,OAAOL,EAAE,CAAC;IAACQ,IAAI,EAAE;EAAiC,CAAC,CAAC;AACtD,CAAC;AAED,IAAMC,OAAO,GAAG,SAAVA,OAAOA,CAAGJ,OAAO,EAAI;EACzB,OAAOL,EAAE,CAAC;IAACQ,IAAI,EAAE;EAAiC,CAAC,CAAC;AACtD,CAAC;AAED,IAAME,OAAO,GAAG,SAAVA,OAAOA,CAAIC,MAAW;EAAA,OAAK,YAAM;IACrC,IAAMC,GAAG,GAAGD,MAAM,CAACE,KAAK,CAACC,OAAO,CAACC,IAAI,CAACH,GAAG;IACzC,IAAMI,SAAS,GAAG,IAAIC,SAAS,iCAA+BL,GAAG,CAAG;IAEpE,OAAOZ,EAAE,CAACgB,SAAS,CAAC,CACjBE,IAAI,CAACjB,QAAQ,CAACG,OAAO,CAAC,CAAC,CACvBc,IAAI,CAAChB,UAAU,CAACO,OAAO,CAAC,CAAC;EAC9B,CAAC;AAAA;AAED,gBAAe,UAACU,OAAO,EAAER,MAAM;EAAA,OAAKQ,OAAO,CACxCD,IAAI,CAACnB,MAAM,CAACI,WAAW,CAACK,IAAI,CAAC,CAAC,CAC9BU,IAAI,CAACjB,QAAQ,CAACS,OAAO,CAACC,MAAM,CAAC,CAAC,CAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}